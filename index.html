<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>JEE Performance & Planner | Animated & Glowing (Fixed)</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.0/dist/chart.umd.min.js"></script>
    <style>
        /* BASE & RESET */
        :root {
            /* Minimalist Dark Mode Colors */
            --color-dark-bg: #0c0c0c; /* Deep Black */
            --color-dark-card: #1e1e1e; /* Darker card background */
            --color-dark-text: #f0f0f0;
            --color-dark-subtext: #999;
            --color-dark-border: #383838; /* Soft Border */
            --color-dark-primary: #ffffff; 
            --color-dark-secondary: #242424; 
            --color-dark-accent: #8a2be2; /* BlueViolet for glow/highlight */

            /* Minimalist Light Mode Colors */
            --color-light-bg: #f5f5f5; 
            --color-light-card: #ffffff; 
            --color-light-text: #1a1a1a;
            --color-light-subtext: #666;
            --color-light-border: #ccc;
            --color-light-primary: #000000;
            --color-light-secondary: #e0e0e0;
            --color-light-accent: #9370db; /* MediumPurple */
            
            --transition-speed: 0.3s;
            --pulse-speed: 2s;
            --font-mono: 'Menlo', 'Consolas', 'Monaco', monospace;
            --font-sans: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, sans-serif;
        }

        /* KEYFRAMES FOR ANIMATIONS */
        @keyframes fadeInSlideUp {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        @keyframes pulseGlowDark {
            0% { text-shadow: 0 0 5px var(--color-dark-accent); }
            50% { text-shadow: 0 0 15px var(--color-dark-accent); }
            100% { text-shadow: 0 0 5px var(--color-dark-accent); }
        }
        
        @keyframes pulseGlowLight {
            0% { text-shadow: 0 0 5px var(--color-light-accent); }
            50% { text-shadow: 0 0 15px var(--color-light-accent); }
            100% { text-shadow: 0 0 5px var(--color-light-accent); }
        }

        @keyframes ripple {
            from { transform: scale(0); opacity: 0.7; }
            to { transform: scale(4); opacity: 0; }
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        html {
            scroll-behavior: smooth;
        }

        body {
            font-family: var(--font-sans);
            background: linear-gradient(145deg, var(--color-dark-bg) 0%, #000000 100%);
            background-attachment: fixed; 
            min-height: 100vh;
            padding: 30px 15px;
            color: var(--color-dark-text);
            transition: background var(--transition-speed) ease, color var(--transition-speed) ease;
        }

        body.light-mode {
            background: linear-gradient(145deg, var(--color-light-bg) 0%, #ffffff 100%);
            background-attachment: fixed;
            color: var(--color-light-text);
        }

        .container {
            max-width: 1000px;
            margin: 0 auto;
            position: relative; 
            z-index: 10;
        }
        
        /* CARD STYLES & GLOW */
        .card {
            background: var(--color-dark-card);
            border-radius: 15px; 
            padding: 25px;
            margin-bottom: 30px; 
            box-shadow: 0 5px 20px rgba(0, 0, 0, 0.4), inset 0 0 0 1px var(--color-dark-border), 0 0 10px rgba(138, 43, 226, 0.2); 
            border: none;
            transition: all var(--transition-speed) ease, transform 0.2s;
            opacity: 0; 
            transform: translateY(20px); 
            animation: fadeInSlideUp 0.6s ease-out forwards; 
        }
        
        body.light-mode .card {
            background: var(--color-light-card);
            box-shadow: 0 5px 20px rgba(0, 0, 0, 0.1), inset 0 0 0 1px var(--color-light-border), 0 0 10px rgba(147, 112, 219, 0.2); 
        }

        .card:hover {
            transform: translateY(-5px) scale(1.005); 
            box-shadow: 0 15px 40px rgba(0, 0, 0, 0.7), 0 0 20px var(--color-dark-accent); 
        }
        
        body.light-mode .card:hover {
            box-shadow: 0 15px 40px rgba(0, 0, 0, 0.2), 0 0 20px var(--color-light-accent); 
        }
        
        /* NAVIGATION TABS */
        .navigation-tabs {
            display: flex;
            gap: 5px;
            margin-bottom: 25px;
            border-bottom: 1px solid var(--color-dark-border);
            margin-top: -5px; 
        }
        .navigation-tabs button {
            padding: 10px 15px;
            border-radius: 10px 10px 0 0; 
            background: var(--color-dark-secondary);
            color: var(--color-dark-subtext);
            border: 1px solid var(--color-dark-border);
            border-bottom: none;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 0.5px;
            transition: all 0.2s ease;
            box-shadow: none !important; 
        }
        .navigation-tabs button.active {
            background: var(--color-dark-text);
            color: var(--color-dark-bg);
            border-color: var(--color-dark-text);
            transform: translateY(-2px);
            box-shadow: 0 -2px 10px rgba(0, 0, 0, 0.4);
        }
        body.light-mode .navigation-tabs { border-bottom: 1px solid var(--color-light-border); }
        body.light-mode .navigation-tabs button { background: var(--color-light-secondary); color: var(--color-light-subtext); border: 1px solid var(--color-light-border); border-bottom: none;}
        body.light-mode .navigation-tabs button.active { background: var(--color-light-primary); color: var(--color-light-card); border-color: var(--color-light-primary); }

        /* TYPOGRAPHY */
        h1 { font-size: 2.5rem; margin-bottom: 5px; letter-spacing: -1px; color: var(--color-dark-primary); font-weight: 800;}
        body.light-mode h1 { color: var(--color-light-primary); }
        h2 { font-size: 1.6rem; margin-bottom: 20px; text-transform: uppercase; letter-spacing: 1.5px; color: var(--color-dark-primary); border-bottom: 1px solid var(--color-dark-border); padding-bottom: 10px; font-weight: 600; }
        body.light-mode h2 { color: var(--color-light-primary); border-bottom: 1px solid var(--color-light-border); }
        h3 { font-size: 1.2rem; color: var(--color-dark-text); font-weight: 600;}
        body.light-mode h3 { color: var(--color-light-text); }
        .subtitle { color: var(--color-dark-subtext); margin-bottom: 20px; font-size: 1rem; letter-spacing: 0.5px; }
        body.light-mode .subtitle { color: var(--color-light-subtext); }

        /* Form and Grid structure for inputs */
        .form-group {
            display: flex;
            flex-direction: column;
        }
        label {
            margin-bottom: 2px;
            font-size: 0.85rem;
            color: var(--color-dark-subtext);
        }
        body.light-mode label { color: var(--color-light-subtext); }

        input, textarea, select {
            padding: 10px 12px; 
            border: 1px solid var(--color-dark-border); 
            background: var(--color-dark-secondary); 
            border-radius: 8px; 
            color: var(--color-dark-text);
            transition: border-color 0.2s ease, box-shadow 0.2s ease;
        }
        body.light-mode input, body.light-mode textarea, body.light-mode select {
            background: var(--color-light-secondary);
            border-color: var(--color-light-border);
            color: var(--color-light-text);
        }

        input:focus, textarea:focus, select:focus {
            outline: none;
            border-color: var(--color-dark-accent);
            box-shadow: 0 0 8px rgba(138, 43, 226, 0.6); 
        }
        body.light-mode input:focus, body.light-mode textarea:focus, body.light-mode select:focus {
            border-color: var(--color-light-accent);
            box-shadow: 0 0 8px rgba(147, 112, 219, 0.6);
        }

        input[type="date"] {
            line-height: 1.2; 
        }

        /* Calendar Styles (COMPACT) */
        .calendar-wrapper { 
            max-width: 300px; 
            flex-shrink: 0; 
        }
        .calendar-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
        }
        
        .calendar-grid { 
            display: grid; 
            grid-template-columns: repeat(7, 1fr); 
            gap: 1px; 
            text-align: center; 
            font-size: 0.8rem; 
            border: 1px solid var(--color-dark-border); 
            border-radius: 10px; 
            overflow: hidden;
            background: var(--color-dark-secondary);
        }
        body.light-mode .calendar-grid { background: var(--color-light-secondary); border-color: var(--color-light-border); }

        .calendar-day-name { 
            font-weight: 600; 
            padding: 5px 0; 
            font-size: 0.75rem;
            color: var(--color-dark-subtext); 
            background: var(--color-dark-card); 
            border-bottom: 1px solid var(--color-dark-border);
        }
        body.light-mode .calendar-day-name { background: var(--color-light-card); border-bottom: 1px solid var(--color-light-border); color: var(--color-light-subtext); }

        .calendar-day { 
            padding: 8px 0; 
            position: relative; 
            cursor: pointer;
            transition: background-color 0.2s ease, color 0.2s ease, transform 0.1s ease;
            height: 40px; 
            display: flex;
            justify-content: center;
            align-items: center;
            border: 1px solid var(--color-dark-secondary); 
        }
        .calendar-day:hover:not(.inactive) {
            background-color: var(--color-dark-accent); 
            color: var(--color-dark-primary);
            transform: scale(1.05);
            z-index: 1;
        }
        body.light-mode .calendar-day:hover:not(.inactive) {
            background-color: var(--color-light-accent);
            color: var(--color-light-primary);
        }

        .calendar-day.inactive {
            color: var(--color-dark-border);
            cursor: not-allowed;
            background: var(--color-dark-card);
        }
        body.light-mode .calendar-day.inactive { color: var(--color-light-border); background: var(--color-light-card); }

        .calendar-day.today {
            background-color: rgba(138, 43, 226, 0.4); 
            font-weight: bold;
            border: 1px solid var(--color-dark-accent);
        }
        body.light-mode .calendar-day.today { background-color: rgba(147, 112, 219, 0.2); border: 1px solid var(--color-light-accent); }

        .calendar-day.selected {
            background-color: var(--color-dark-accent);
            color: var(--color-dark-primary);
            font-weight: bold;
            box-shadow: 0 0 10px var(--color-dark-accent); 
        }
        body.light-mode .calendar-day.selected { background-color: var(--color-light-accent); color: var(--color-light-primary); box-shadow: 0 0 10px var(--color-light-accent); }

        .task-dot {
            width: 6px;
            height: 6px;
            background-color: var(--color-dark-primary); 
            border-radius: 50%;
            position: absolute;
            bottom: 4px;
            right: 4px;
        }
        body.light-mode .task-dot { background-color: var(--color-light-primary); }

        /* Log Entry Styling */
        .log-entry, .student-note-entry {
            border-left: 4px solid var(--color-dark-accent); 
            padding: 15px; 
            background: var(--color-dark-secondary);
            border-radius: 10px; 
            margin-bottom: 15px; 
            display: flex;
            flex-direction: column; 
            align-items: flex-start;
            transition: all 0.4s ease; 
            opacity: 0; 
            transform: translateX(-20px); 
        }
        body.light-mode .log-entry, body.light-mode .student-note-entry { border-left: 4px solid var(--color-light-accent); background: var(--color-light-secondary); }
        
        /* STUDENT LOG specific styles */
        .student-note-entry.log-visible {
             opacity: 1; 
             transform: translateX(0); 
        }

        .student-note-header {
            display: flex;
            justify-content: space-between;
            width: 100%;
            margin-bottom: 8px;
            font-size: 0.9rem;
            color: var(--color-dark-subtext);
        }
        .student-note-text {
            font-size: 1rem;
            white-space: pre-wrap; 
            color: var(--color-dark-text);
            line-height: 1.4;
        }
        body.light-mode .student-note-text { color: var(--color-light-text); }
        

        .log-details { 
            flex-grow: 1; 
            margin-right: 15px; 
            width: 100%;
            padding-bottom: 5px;
        }
        
        .log-date-time {
            font-size: 0.9rem;
            display: flex;
            justify-content: space-between;
            width: 100%;
            margin-bottom: 5px;
            color: var(--color-dark-subtext);
        }
        
        .log-description {
            font-size: 1rem;
            font-weight: 400;
            color: var(--color-dark-text);
        }

        .log-actions-wrapper { 
            display: flex; 
            align-items: center; 
            justify-content: space-between;
            width: 100%; 
            margin-top: 10px; 
        }
        
        .log-hours { 
            font-family: var(--font-mono); 
            color: var(--color-dark-subtext); 
            font-size: 0.85rem; 
            font-weight: 600;
        }
        
        .log-actions-wrapper .btn-delete {
            padding: 6px 10px; 
            font-size: 0.75rem;
            border-radius: 6px;
        }

        @media (min-width: 768px) {
            .log-entry { flex-direction: row; align-items: center; justify-content: space-between; }
            .log-details { width: auto; margin-right: 20px; padding-bottom: 0; }
            .log-date-time { width: auto; justify-content: flex-start; gap: 10px; margin-bottom: 0;}
            .log-actions-wrapper { width: auto; margin-top: 0; }
        }

        /* BUTTONS & RIPPLE EFFECT */
        button { 
            padding: 12px 20px;
            border-radius: 10px; 
            font-size: 1rem;
            font-weight: 600;
            cursor: pointer;
            border: none;
            position: relative;
            overflow: hidden;
            transition: all var(--transition-speed) cubic-bezier(0.25, 0.46, 0.45, 0.94); 
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.2); 
        }
        
        .btn-primary {
            background-color: var(--color-dark-primary);
            color: var(--color-dark-bg);
        }
        body.light-mode .btn-primary {
            background-color: var(--color-light-primary);
            color: var(--color-light-card);
        }
        .btn-primary:hover {
            transform: translateY(-2px) scale(1.02);
            box-shadow: 0 8px 20px rgba(255, 255, 255, 0.15), 0 0 15px rgba(255, 255, 255, 0.4); 
        }
        body.light-mode .btn-primary:hover {
            box-shadow: 0 8px 20px rgba(0, 0, 0, 0.15), 0 0 15px rgba(0, 0, 0, 0.3); 
        }

        .btn-secondary {
            background-color: var(--color-dark-secondary);
            color: var(--color-dark-text);
            border: 1px solid var(--color-dark-border);
        }
        body.light-mode .btn-secondary {
            background-color: var(--color-light-secondary);
            color: var(--color-light-text);
            border: 1px solid var(--color-light-border);
        }
        .btn-secondary:hover {
            transform: translateY(-2px) scale(1.02);
            box-shadow: 0 8px 20px rgba(0, 0, 0, 0.3), 0 0 15px var(--color-dark-accent); 
        }
        body.light-mode .btn-secondary:hover {
            box-shadow: 0 8px 20px rgba(0, 0, 0, 0.1), 0 0 15px var(--color-light-accent);
        }

        .btn-delete {
            background-color: #d32f2f; 
            color: white;
            padding: 8px 12px;
            font-size: 0.85rem;
            border-radius: 8px;
            box-shadow: none; 
        }
        .btn-delete:hover {
            background-color: #e53935;
            transform: translateY(-1px) scale(1.05);
            box-shadow: 0 2px 8px rgba(211, 47, 47, 0.6);
        }

        /* RIPPLE EFFECT STYLES */
        .ripple {
            position: absolute;
            border-radius: 50%;
            opacity: 1;
            transform: scale(0);
            animation: ripple 0.6s linear;
            background-color: rgba(255, 255, 255, 0.5); 
        }
        body.light-mode .ripple {
            background-color: rgba(0, 0, 0, 0.3); 
        }

        .button-group {
            display: flex;
            gap: 10px;
            margin-top: 25px;
            flex-wrap: wrap;
        }
        .button-group button {
            flex-grow: 1; 
            min-width: 150px; 
            margin-bottom: 10px; 
        }

        /* STOPWATCH SPECIFIC STYLES */
        .stopwatch-display {
            font-size: 3.8rem; 
            letter-spacing: 3px; 
            font-family: var(--font-mono);
            color: var(--color-dark-primary);
            text-align: center;
            margin: 20px 0 30px;
            text-shadow: 0 0 10px rgba(138, 43, 226, 0.7); 
            transition: all var(--transition-speed) ease;
        }
        body.light-mode .stopwatch-display {
            color: var(--color-light-primary);
            text-shadow: 0 0 10px rgba(147, 112, 219, 0.7);
        }

        .stopwatch-display.running {
            animation: pulseGlowDark var(--pulse-speed) infinite alternate ease-in-out; 
        }
        body.light-mode .stopwatch-display.running {
             animation: pulseGlowLight var(--pulse-speed) infinite alternate ease-in-out;
        }

        .stopwatch-controls {
            display: flex;
            gap: 15px;
            justify-content: center;
        }
        .stopwatch-controls button {
            min-width: 120px;
        }
        .start-btn-custom {
            background-color: #4CAF50; 
            color: white;
        }
        .start-btn-custom:hover {
            background-color: #66BB6A;
            box-shadow: 0 8px 20px rgba(76, 175, 80, 0.3), 0 0 15px rgba(76, 175, 80, 0.5);
        }
        .stop-btn-custom {
            background-color: #f44336; 
            color: white;
        }
        .stop-btn-custom:hover {
            background-color: #ef5350;
            box-shadow: 0 8px 20px rgba(244, 67, 54, 0.3), 0 0 15px rgba(244, 67, 54, 0.5);
        }


        /* FOOTER & ANIMATION */
        .footer {
            padding-top: 50px; 
            letter-spacing: 0.5px;
            text-align: center;
            font-size: 0.9rem;
            color: var(--color-dark-subtext);
            transition: color var(--transition-speed) ease;
        }

        .syllabus-status-select {
            padding: 8px;
            border-radius: 8px; 
            background: var(--color-dark-secondary);
            color: var(--color-dark-text);
            border: 1px solid var(--color-dark-border);
        }
        body.light-mode .syllabus-status-select {
            background: var(--color-light-secondary);
            color: var(--color-light-text);
            border: 1px solid var(--color-light-border);
        }
        
        .resource-link-button {
            display: block;
            text-align: left;
            padding: 10px 15px;
            margin-bottom: 10px;
            border-radius: 10px;
            background: var(--color-dark-secondary);
            color: var(--color-dark-text);
            border: 1px solid var(--color-dark-border);
            font-weight: 500;
            transition: all 0.2s;
        }
        .resource-link-button:hover {
            background: var(--color-dark-accent);
            transform: translateX(5px);
            color: white;
        }
        body.light-mode .resource-link-button {
            background: var(--color-light-secondary);
            color: var(--color-light-text);
            border: 1px solid var(--color-light-border);
        }
        body.light-mode .resource-link-button:hover {
            background: var(--color-light-accent);
            color: var(--color-light-primary);
        }

        .pomodoro-info {
            padding: 15px;
            border-left: 4px solid var(--color-dark-accent);
            background: var(--color-dark-card);
            border-radius: 10px;
            margin-top: 15px;
        }
        body.light-mode .pomodoro-info {
            border-left: 4px solid var(--color-light-accent);
            background: var(--color-light-secondary);
        }
    </style>
</head>
<body>
    <button class="theme-toggle" onclick="toggleTheme()" id="themeToggle">üåô</button>
    
    <div class="container">
        
        <div class="card" data-idx="1">
            <h1>üéì JEE TRACKER</h1>
            <p class="subtitle">A highly focused, minimalist interface for performance tracking, planning, and student resources.</p>
            
            <div class="button-group">
                <button class="btn-primary" onclick="exportData()">üì• EXPORT DATA</button>
                <button class="btn-secondary" onclick="document.getElementById('importFile').click()">üì§ IMPORT DATA</button>
                <input type="file" id="importFile" accept=".json" onchange="importData(event)" style="display: none;">
            </div>
        </div>

        <div class="navigation-tabs">
            <button class="active" onclick="switchView('performanceView', this)">Performance & Planner</button>
            <button onclick="switchView('studentHubView', this)">Student Hub</button>
        </div>

        <div id="performanceView" class="view">
            <div id="statsContainer" class="card hidden" data-idx="2"></div>
            
            <div class="card" data-idx="3">
                <h2>‚è±Ô∏è STUDY TIMER</h2>
                <div class="stopwatch-display" id="stopwatchDisplay">00:00:00</div>
                <div class="stopwatch-controls">
                    <button class="btn-primary start-btn-custom" style="width: auto; margin: 0;" onclick="startStopwatch()" id="startStopBtn">Start</button>
                    <button class="btn-secondary" style="width: auto; margin: 0;" onclick="resetStopwatch()">Reset</button>
                </div>
            </div>

            <div class="card" data-idx="4">
                <h2>üìä ADD TEST SCORE</h2>
                <div class="form-grid">
                    <div class="form-group"><label>Test Date</label><input type="date" id="testDate" required></div>
                    <div class="form-group"><label>Physics Marks</label><input type="number" id="physics" step="0.01" placeholder="0" required></div>
                    <div class="form-group"><label>Chemistry Marks</label><input type="number" id="chemistry" step="0.01" placeholder="0" required></div>
                    <div class="form-group"><label>Maths Marks</label><input type="number" id="maths" step="0.01" placeholder="0" required></div>
                    <div class="form-group"><label>Total Marks</label><input type="number" id="totalMarks" value="300" required></div>
                </div>
                <button class="btn-primary" onclick="addTest()">ADD TEST RESULT</button>
            </div>

            <div class="card" id="chartCard" style="display: none;" data-idx="5">
                <h2>üìà PERFORMANCE TREND</h2>
                <div class="chart-container">
                    <canvas id="trendChart"></canvas>
                </div>
            </div>

            <div class="card" id="tableCard" style="display: none;" data-idx="6">
                <h2>üìã TEST HISTORY</h2>
                <div style="overflow-x: auto;">
                    <table id="testTable">
                        <thead>
                            <tr>
                                <th>Date</th><th>Physics</th><th>Chemistry</th><th>Maths</th><th>Total</th><th>Percentage</th><th>Action</th>
                            </tr>
                        </thead>
                        <tbody id="testTableBody"></tbody>
                    </table>
                </div>
            </div>

            <div class="card" data-idx="7">
                <h2>üìÖ STUDY PLANNER</h2>
                <div class="calendar-task-layout">
                    <div class="calendar-wrapper">
                        <div class="calendar-header">
                            <button class="btn-secondary" onclick="changeMonth(-1)" title="Previous Month">&#9664;</button>
                            <h3 id="currentMonthYear"></h3>
                            <button class="btn-secondary" onclick="changeMonth(1)" title="Next Month">&#9654;</button>
                        </div>
                        <div class="calendar-grid" id="calendarGrid">
                            <div class="calendar-day-name">S</div><div class="calendar-day-name">M</div><div class="calendar-day-name">T</div><div class="calendar-day-name">W</div><div class="calendar-day-name">T</div><div class="calendar-day-name">F</div><div class="calendar-day-name">S</div>
                        </div>
                    </div>

                    <div class="task-section">
                        <h3 id="selectedDateTitle">SELECT A DATE</h3>
                        
                        <div class="form-group task-input-form" style="margin-top: 15px;">
                            <label for="taskInput">New Task/Work</label>
                            <textarea id="taskInput" placeholder="Enter your task here: e.g., Revise Kinematics" rows="2"></textarea>
                            <button class="btn-primary" onclick="addTask()">ADD TASK</button>
                        </div>

                        <div class="task-display">
                            <h4 style="margin-bottom: 10px; color: var(--color-dark-subtext);">PENDING TASKS:</h4>
                            <div id="taskList">
                                <p class="empty-state" style="padding: 10px; margin-top: 10px; border-top: none;">NO TASKS FOR THIS DATE.</p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            
            <div class="card" data-idx="8">
                <h2>
                    ‚è≥ STUDY LOG 
                    <span style="font-size: 1rem; color: var(--color-dark-text);" id="totalStudyHours">TOTAL LOGGED: 0.0 HRS</span>
                </h2>

                <div class="log-form-grid">
                    <div class="form-group"><label>Date</label><input type="date" id="logDate" required></div>
                    <div class="form-group"><label>Time Block</label><input type="text" id="logTime" placeholder="10:00 AM - 1:00 PM" required></div>
                    <div class="form-group"><label>Activity Studied</label><input type="text" id="logActivity" placeholder="Physics numericals, Organic chemistry theory" required></div>
                </div>
                <button class="btn-primary" onclick="addStudyLog()">LOG SESSION</button>
                
                <h3 style="color: var(--color-dark-subtext); margin-top: 25px; margin-bottom: 10px;">RECENT SESSIONS</h3>
                <div id="studyLogList">
                    <p class="empty-state" style="padding: 10px; border-top: none;">NO STUDY SESSIONS LOGGED YET.</p>
                </div>
            </div>
        </div>

        <div id="studentHubView" class="view hidden">
            
            <div class="card">
                <h2>‚öôÔ∏è PRODUCTIVITY TOOLS</h2>
                
                <h3 style="margin-bottom: 15px;">üî¢ SCIENTIFIC CALCULATORS (Quick Access)</h3>
                <div class="form-grid">
                    <a href="https://www.desmos.com/scientific" target="_blank" class="resource-link-button">Desmos Scientific Calculator</a>
                    <a href="https://www.calculators-math.com/complex-number-calculator/" target="_blank" class="resource-link-button">Complex Number Calculator</a>
                    <a href="https://www.emathhelp.net/math-solver/calculus-calculator/" target="_blank" class="resource-link-button">Calculus Solver (eMathHelp)</a>
                    <a href="https://www.maplesoft.com/products/MapleCalculator/" target="_blank" class="resource-link-button">Maple Math Solver</a>
                </div>

                <h3 style="margin-top: 20px; margin-bottom: 10px;">‚è±Ô∏è POMODORO FOCUS</h3>
                <div class="pomodoro-info">
                    <p class="subtitle" style="margin-bottom: 5px;">Use the Pomodoro Technique (25 min focus / 5 min break) to maximize concentration. Your main study timer is on the Performance tab.</p>
                    <div class="form-grid" style="grid-template-columns: repeat(auto-fit, minmax(140px, 1fr));">
                        <a href="https://pomodoro-tracker.com/" target="_blank" class="btn-secondary" style="text-align: center; margin: 0; padding: 8px 12px;">Pomodoro Tracker</a>
                        <a href="https://www.focustodo.cn/" target="_blank" class="btn-secondary" style="text-align: center; margin: 0; padding: 8px 12px;">Focus To-Do</a>
                        <a href="https://nesto.cc/" target="_blank" class="btn-secondary" style="text-align: center; margin: 0; padding: 8px 12px;">Nesto Timer</a>
                    </div>
                </div>
            </div>

            <div class="card">
                <h2>üéØ GOALS & MOTIVATION</h2>
                <div class="form-grid" style="grid-template-columns: 1fr 1fr;">
                    <div class="form-group">
                        <label for="targetScore">Target JEE Score (Max 300)</label>
                        <input type="number" id="targetScore" placeholder="e.g., 250" required>
                    </div>
                    <div class="form-group">
                        <label for="targetPercentile">Target Percentile</label>
                        <input type="number" id="targetPercentile" placeholder="e.g., 99.5" step="0.01" required>
                    </div>
                </div>
                <div class="form-group">
                    <label for="motivationalQuote">Motivational Quote</label>
                    <textarea id="motivationalQuote" rows="2" placeholder="Write your daily motivation here..."></textarea>
                </div>
                <button class="btn-primary" onclick="saveGoals()">SAVE GOALS</button>
                <p style="margin-top: 15px; text-align: center; font-size: 1.1rem;" id="goalDisplay"></p>
            </div>
            
            <div class="card">
                <h2>üß† STUDENT LOG</h2>
                <div class="form-group">
                    <label for="studentLogEntry">Daily Reflection/Mindset Note</label>
                    <textarea id="studentLogEntry" rows="4" placeholder="How was your study day? What was your biggest challenge or breakthrough?"></textarea>
                </div>
                <button class="btn-primary" onclick="addStudentNote()">ADD LOG ENTRY</button>

                <h3 style="color: var(--color-dark-subtext); margin-top: 25px; margin-bottom: 10px;">RECENT NOTES</h3>
                <div id="studentNoteList">
                    <p class="empty-state" style="padding: 10px; border-top: none;">No student log entries yet.</p>
                </div>
            </div>

            <div class="card">
                <h2>üìö SYLLABUS TRACKER</h2>
                <div class="form-grid" style="grid-template-columns: 1fr 1fr 1fr auto;">
                    <div class="form-group">
                        <label for="syllabusSubject">Subject</label>
                        <select id="syllabusSubject">
                            <option value="Physics">Physics</option>
                            <option value="Chemistry">Chemistry</option>
                            <option value="Maths">Maths</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="syllabusChapter">Chapter Name</label>
                        <input type="text" id="syllabusChapter" placeholder="e.g., Electrostatics">
                    </div>
                    <div class="form-group">
                        <label for="syllabusStatus">Status</label>
                        <select id="syllabusStatus">
                            <option value="Pending">Pending</option>
                            <option value="Revision 1">Revision 1</option>
                            <option value="Completed">Completed</option>
                        </select>
                    </div>
                    <button class="btn-primary" style="align-self: flex-end; width: auto; margin-top: 0;" onclick="addSyllabusItem()">ADD CHAPTER</button>
                </div>

                <h3 style="color: var(--color-dark-subtext); margin-top: 25px; margin-bottom: 10px;">PROGRESS</h3>
                <div style="overflow-x: auto;">
                    <table id="syllabusTable">
                        <thead>
                            <tr>
                                <th>Subject</th><th>Chapter</th><th>Status</th><th>Action</th>
                            </tr>
                        </thead>
                        <tbody id="syllabusTableBody"></tbody>
                    </table>
                </div>
                <p style="margin-top: 15px; font-weight: 600;" id="syllabusProgressSummary"></p>
            </div>
            
            <div class="card">
                <h2>üîó RESOURCE LINKS</h2>
                <div class="form-grid" style="grid-template-columns: 1fr 2fr auto;">
                    <div class="form-group">
                        <label for="resourceName">Link Name</label>
                        <input type="text" id="resourceName" placeholder="e.g., P.Y.P. PDF">
                    </div>
                    <div class="form-group">
                        <label for="resourceURL">URL</label>
                        <input type="url" id="resourceURL" placeholder="https://example.com/link">
                    </div>
                    <button class="btn-primary" style="align-self: flex-end; width: auto; margin-top: 0;" onclick="addResourceLink()">ADD LINK</button>
                </div>
                <h3 style="color: var(--color-dark-subtext); margin-top: 25px; margin-bottom: 10px;">SAVED LINKS</h3>
                <div id="resourceLinkList">
                    <p class="empty-state" style="padding: 10px; border-top: none;">No resources saved yet.</p>
                </div>
            </div>

        </div>


        <div class="footer">
            Designed with <span style="font-family: var(--font-mono); font-size: 1.1em; color: var(--color-dark-text);">|</span> and ‚òï by <a href="https://github.com/TNMY-3010" target="_blank">TNMY-3010</a>
        </div>
    </div>


    <script>
        // --- Core Data Arrays ---
        let tests = [];
        let tasks = {};
        let studyLogs = []; 
        let syllabusItems = []; 
        let resourceLinks = []; 
        let goals = {}; 
        let studentNotes = []; 

        // --- Planner State ---
        let currentMonth = new Date().getMonth();
        let currentYear = new Date().getFullYear();
        let selectedDate = new Date(); 
        
        // --- Stopwatch State ---
        let stopwatchInterval;
        let stopwatchRunning = false;
        let elapsedTime = 0; 
        
        // --- Utility: Card Animations on Load ---
        function animateCards() {
            const cards = document.querySelectorAll('.card');
            cards.forEach((card, index) => {
                setTimeout(() => {
                    card.style.opacity = '1';
                    card.style.transform = 'translateY(0)';
                }, 50 * index);
            });
        }
        
        // --- Utility: Button Ripple Effect ---
        document.querySelectorAll('button').forEach(button => {
            button.addEventListener('click', function(e) {
                const rect = button.getBoundingClientRect();
                const size = Math.max(rect.width, rect.height);
                const x = e.clientX - rect.left - size / 2;
                const y = e.clientY - rect.top - size / 2;

                const ripple = document.createElement('span');
                ripple.classList.add('ripple');
                ripple.style.width = ripple.style.height = `${size}px`;
                ripple.style.left = `${x}px`;
                ripple.style.top = `${y}px`;

                button.appendChild(ripple);
                setTimeout(() => ripple.remove(), 600);
            });
        });

        // --- VIEW SWITCHER ---
        function switchView(viewId, button) {
            document.querySelectorAll('.view').forEach(view => {
                view.classList.add('hidden');
            });
            document.getElementById(viewId).classList.remove('hidden');

            document.querySelectorAll('.navigation-tabs button').forEach(btn => {
                btn.classList.remove('active');
            });
            button.classList.add('active');

            if (viewId === 'studentHubView') {
                renderGoals();
                renderStudentNotes(); 
                renderSyllabusTracker();
                renderResourceLinks();
            } else if (viewId === 'performanceView') {
                updateUI();
            }
        }


        // --- INITIALIZATION ---
        window.onload = function() {
            loadTests();
            loadTasks(); 
            loadStudyLogs(); 
            loadSyllabus(); 
            loadResources(); 
            loadGoals(); 
            loadStudentNotes(); 
            loadTheme();
            updateUI(); 
            
            renderCalendar(); 
            selectDate(new Date().toDateString()); 
            
            animateCards(); 
            
            switchView('performanceView', document.querySelector('.navigation-tabs button:first-child'));
        };

        // --- Theme Functions (Unchanged) ---
        function loadTheme() {
            const savedTheme = localStorage.getItem('jee-theme');
            const systemPrefersDark = window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches;
            
            if (savedTheme === 'light' || (!savedTheme && !systemPrefersDark)) {
                document.body.classList.add('light-mode');
                document.getElementById('themeToggle').textContent = 'üåô';
            } else {
                document.getElementById('themeToggle').textContent = '‚òÄÔ∏è';
            }
            updateChart(); 
        }

        function toggleTheme() {
            const body = document.body;
            const toggle = document.getElementById('themeToggle');
            
            body.classList.toggle('light-mode');
            
            if (body.classList.contains('light-mode')) {
                toggle.textContent = 'üåô';
                localStorage.setItem('jee-theme', 'light');
            } else {
                toggle.textContent = '‚òÄÔ∏è';
                localStorage.setItem('jee-theme', 'dark');
            }
            updateChart(); 
        }

        // --- Data Import/Export Functions (Unchanged) ---
        function exportData() {
            const exportObject = { tests, tasks, studyLogs, syllabusItems, resourceLinks, goals, studentNotes };
            const dataStr = JSON.stringify(exportObject, null, 2);
            const dataBlob = new Blob([dataStr], { type: 'application/json' });
            const url = URL.createObjectURL(dataBlob);
            const link = document.createElement('a');
            link.href = url;
            link.download = `jee-tracker-backup-${new Date().toISOString().split('T')[0]}.json`;
            link.click();
            URL.revokeObjectURL(url);
        }

        function importData(event) {
            const file = event.target.files[0];
            if (file) {
                const reader = new FileReader();
                reader.onload = function(e) {
                    try {
                        const importedData = JSON.parse(e.target.result);
                        
                        if (importedData.tests) { tests = importedData.tests; saveTests(); }
                        if (importedData.tasks) { tasks = importedData.tasks; saveTasks(); }
                        if (importedData.studyLogs) { studyLogs = importedData.studyLogs; saveStudyLogs(); } 
                        if (importedData.syllabusItems) { syllabusItems = importedData.syllabusItems; saveSyllabus(); } 
                        if (importedData.resourceLinks) { resourceLinks = importedData.resourceLinks; saveResources(); } 
                        if (importedData.goals) { goals = importedData.goals; saveGoals(); } 
                        if (importedData.studentNotes) { studentNotes = importedData.studentNotes; saveStudentNotes(); } 
                        
                        renderCalendar();
                        updateUI();
                        renderSyllabusTracker(); 
                        renderResourceLinks(); 
                        renderGoals(); 
                        renderStudentNotes(); 
                        
                        alert('Data imported successfully!');
                    } catch (error) {
                        alert('Error importing data. Please check the file format.');
                    }
                };
                reader.readAsText(file);
            }
        }
        
        // --- TEST TRACKER FUNCTIONS (Unchanged) ---
        function loadTests() {
            const saved = localStorage.getItem('jee-tests');
            if (saved) {
                try { tests = JSON.parse(saved); } catch (e) { console.error('Error loading tests:', e); tests = []; }
            }
        }
        function saveTests() { localStorage.setItem('jee-tests', JSON.stringify(tests)); }
        
        function addTest() {
            const date = document.getElementById('testDate').value;
            const physics = parseFloat(document.getElementById('physics').value);
            const chemistry = parseFloat(document.getElementById('chemistry').value);
            const maths = parseFloat(document.getElementById('maths').value);
            const totalMarks = parseFloat(document.getElementById('totalMarks').value);

            if (!date || isNaN(physics) || isNaN(chemistry) || isNaN(maths) || isNaN(totalMarks) || totalMarks <= 0) {
                alert('Please fill in all fields with valid numbers.');
                return;
            }

            const total = physics + chemistry + maths;
            const percentage = (total / totalMarks) * 100;

            const test = { id: Date.now(), date, physics, chemistry, maths, total, totalMarks, percentage };
            tests.push(test);
            tests.sort((a, b) => new Date(a.date) - new Date(b.date));
            saveTests();

            document.getElementById('testDate').value = '';
            document.getElementById('physics').value = '';
            document.getElementById('chemistry').value = '';
            document.getElementById('maths').value = '';
            document.getElementById('totalMarks').value = '300';

            updateUI();
        }

        function deleteTest(id) {
            if (confirm('Are you sure you want to delete this test?')) {
                tests = tests.filter(t => t.id !== id);
                saveTests();
                updateUI();
            }
        }

        function updateUI() {
            updateStats();
            updateChart();
            updateTable();
            renderStudyLogs(); 
        }
        
        function updateStats() {
            const statsContainer = document.getElementById('statsContainer');
            if (tests.length === 0) {
                statsContainer.classList.add('hidden');
                return;
            }
            statsContainer.classList.remove('hidden');

            const latest = tests[tests.length - 1];
            const previous = tests.length > 1 ? tests[tests.length - 2] : null;
            const avgPercentage = tests.reduce((sum, t) => sum + t.percentage, 0) / tests.length;
            
            let progressChange = 0;
            if (previous) {
                const prevTotal = previous.total;
                const latestTotal = latest.total;
                if (prevTotal > 0) {
                    progressChange = ((latestTotal - prevTotal) / prevTotal) * 100;
                } else if (prevTotal === 0 && latestTotal > 0) {
                    progressChange = 100; 
                }
            }

            const nextTestDate = new Date(latest.date);
            nextTestDate.setDate(nextTestDate.getDate() + 21);
            const nextDateStr = nextTestDate.toLocaleDateString('en-GB');
            const progressSymbol = progressChange >= 0 ? '‚ñ≤' : '‚ñº';

            const statsHTML = `
                <div class="stats-grid">
                    <div class="stat-card">
                        <div class="stat-label">Latest Score</div>
                        <div class="stat-value">${latest.total.toFixed(2)}/${latest.totalMarks}</div>
                        <div class="stat-sub">${latest.percentage.toFixed(2)}%</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-label">Progress</div>
                        <div class="stat-value" style="color: ${progressChange >= 0 ? '#888' : '#444'};">${progressSymbol} ${Math.abs(progressChange).toFixed(2)}%</div>
                        <div class="stat-sub">VS PREVIOUS TEST</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-label">Average</div>
                        <div class="stat-value">${avgPercentage.toFixed(2)}%</div>
                        <div class="stat-sub">OVERALL PERFORMANCE</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-label">Next Test Target</div>
                        <div class="stat-value" style="font-size: 1.5rem;">${nextDateStr}</div>
                        <div class="stat-sub">21-DAY CYCLE</div>
                    </div>
                </div>
            `;

            document.getElementById('statsContainer').innerHTML = statsHTML;
        }

        function updateChart() {
            const chartCard = document.getElementById('chartCard');
            if (tests.length === 0) { chartCard.style.display = 'none'; return; }
            chartCard.style.display = 'block';

            const ctx = document.getElementById('trendChart').getContext('2d');
            if (chart) { chart.destroy(); }

            const labels = tests.map(t => new Date(t.date).toLocaleDateString('en-GB', { day: '2-digit', month: 'short' }));
            const isLightMode = document.body.classList.contains('light-mode');
            const textColor = isLightMode ? '#1a1a1a' : '#f0f0f0';
            const gridColor = isLightMode ? 'rgba(0, 0, 0, 0.1)' : 'rgba(255, 255, 255, 0.1)';

            const dataSets = [
                { label: 'Total Score', data: tests.map(t => t.total), borderColor: textColor, backgroundColor: 'rgba(255, 255, 255, 0.2)', borderWidth: 3, tension: 0.4 },
                { label: 'Physics', data: tests.map(t => t.physics), borderColor: '#888', backgroundColor: 'transparent', borderWidth: 1, tension: 0.4 },
                { label: 'Chemistry', data: tests.map(t => t.chemistry), borderColor: '#666', backgroundColor: 'transparent', borderWidth: 1, tension: 0.4 },
                { label: 'Maths', data: tests.map(t => t.maths), borderColor: '#444', backgroundColor: 'transparent', borderWidth: 1, tension: 0.4 }
            ];
            
            if (isLightMode) {
                dataSets[0].borderColor = textColor;
                dataSets[0].backgroundColor = 'rgba(0, 0, 0, 0.1)';
                dataSets[1].borderColor = '#666';
                dataSets[2].borderColor = '#888';
                dataSets[3].borderColor = '#aaa';
            }


            chart = new Chart(ctx, {
                type: 'line',
                data: {
                    labels: labels,
                    datasets: dataSets
                },
                options: {
                    responsive: true, maintainAspectRatio: false,
                    plugins: { legend: { display: true, position: 'top', labels: { color: textColor } } },
                    scales: {
                        y: { beginAtZero: true, title: { display: true, text: 'Marks', color: textColor }, ticks: { color: textColor }, grid: { color: gridColor } },
                        x: { title: { display: true, text: 'Test Date', color: textColor }, ticks: { color: textColor }, grid: { color: gridColor } }
                    }
                }
            });
        }

        function updateTable() {
            const tableCard = document.getElementById('tableCard');
            const tbody = document.getElementById('testTableBody');

            if (tests.length === 0) { tableCard.style.display = 'none'; tbody.innerHTML = ''; return; }
            tableCard.style.display = 'block';

            tbody.innerHTML = tests.map(test => {
                const badgeClass = test.percentage >= 75 ? 'badge-green' : test.percentage >= 50 ? 'badge-yellow' : 'badge-red';
                return `
                    <tr>
                        <td>${new Date(test.date).toLocaleDateString('en-GB')}</td>
                        <td style="color: ${document.body.classList.contains('light-mode') ? '#444' : '#888'}; font-weight: 600;">${test.physics.toFixed(2)}</td>
                        <td style="color: ${document.body.classList.contains('light-mode') ? '#666' : '#999'}; font-weight: 600;">${test.chemistry.toFixed(2)}</td>
                        <td style="color: ${document.body.classList.contains('light-mode') ? '#888' : '#aaa'}; font-weight: 600;">${test.maths.toFixed(2)}</td>
                        <td style="font-weight: bold; color: ${document.body.classList.contains('light-mode') ? '#1a1a1a' : '#f0f0f0'};">${test.total.toFixed(2)}/${test.totalMarks}</td>
                        <td><span class="badge ${badgeClass}">${test.percentage.toFixed(2)}%</span></td>
                        <td><button class="btn-delete" onclick="deleteTest(${test.id})">DELETE</button></td>
                    </tr>
                `;
            }).join('');
        }
        
        // --- Calendar & Task Functions (Unchanged) ---
        function loadTasks() {
            const savedTasks = localStorage.getItem('jee-tasks');
            if (savedTasks) {
                try { tasks = JSON.parse(savedTasks); } catch (e) { console.error('Error loading tasks:', e); tasks = {}; }
            }
        }
        function saveTasks() { localStorage.setItem('jee-tasks', JSON.stringify(tasks)); }
        
        function renderCalendar() {
            const today = new Date();
            const grid = document.getElementById('calendarGrid');
            const header = document.getElementById('currentMonthYear');
            
            while (grid.children.length > 7) { grid.removeChild(grid.lastChild); } 
            
            const monthNames = ["JANUARY", "FEBRUARY", "MARCH", "AIPRIL", "MAY", "JUNE", "JULY", "AUGUST", "SEPTEMBER", "OCTOBER", "NOVEMBER", "DECEMBER"];
            header.textContent = `${monthNames[currentMonth]} ${currentYear}`;
            const firstDayOfMonth = new Date(currentYear, currentMonth, 1).getDay(); 
            const daysInMonth = new Date(currentYear, currentMonth + 1, 0).getDate();
            
            for (let i = 0; i < firstDayOfMonth; i++) {
                const dayDiv = document.createElement('div');
                dayDiv.classList.add('calendar-day', 'inactive');
                dayDiv.textContent = ''; 
                grid.appendChild(dayDiv);
            }

            for (let i = 1; i <= daysInMonth; i++) {
                const dayDiv = document.createElement('div');
                dayDiv.classList.add('calendar-day');
                dayDiv.textContent = i;
                
                const dateStr = new Date(currentYear, currentMonth, i).toDateString();
                dayDiv.setAttribute('data-date', dateStr);
                dayDiv.onclick = () => selectDate(dateStr);
                
                if (i === today.getDate() && currentMonth === today.getMonth() && currentYear === today.getFullYear()) { dayDiv.classList.add('today'); }
                
                if (dateStr === selectedDate.toDateString()) {
                    setTimeout(() => {
                        document.querySelectorAll('.calendar-day.selected').forEach(el => el.classList.remove('selected'));
                        dayDiv.classList.add('selected');
                    }, 0); 
                }

                if (tasks[dateStr] && tasks[dateStr].length > 0) {
                    const dot = document.createElement('span');
                    dot.classList.add('task-dot');
                    dayDiv.appendChild(dot);
                }
                grid.appendChild(dayDiv);
            }

            const currentCells = grid.children.length;
            const cellsNeeded = 7 * Math.ceil((currentCells - 7) / 7 + 1);
            
            for (let i = currentCells; i < cellsNeeded; i++) {
                 const dayDiv = document.createElement('div');
                dayDiv.classList.add('calendar-day', 'inactive');
                dayDiv.textContent = ''; 
                grid.appendChild(dayDiv);
            }
        }
        
        function changeMonth(step) {
            currentMonth += step;
            if (currentMonth > 11) { currentMonth = 0; currentYear++; } else if (currentMonth < 0) { currentMonth = 11; currentYear--; }
            const newDate = new Date(currentYear, currentMonth, selectedDate.getDate());
            if (newDate.getMonth() !== currentMonth) { selectedDate = new Date(currentYear, currentMonth, 1); } else { selectedDate = newDate; }
            renderCalendar();
            selectDate(selectedDate.toDateString());
        }
        
        function selectDate(dateStr) {
            document.querySelectorAll('.calendar-day.selected').forEach(el => el.classList.remove('selected'));
            const newSelectedDayElement = document.querySelector(`.calendar-day[data-date="${dateStr}"]`);
            if(newSelectedDayElement) { newSelectedDayElement.classList.add('selected'); }
            
            selectedDate = new Date(dateStr);
            document.getElementById('selectedDateTitle').textContent = `TASKS FOR ${selectedDate.toLocaleDateString('en-GB', {weekday: 'short', day: 'numeric', month: 'long'}).toUpperCase()}`;
            renderTasks();
        }
        
        function renderTasks() {
            const taskList = document.getElementById('taskList');
            const dateKey = selectedDate.toDateString();
            const dailyTasks = tasks[dateKey] || [];
            
            if (dailyTasks.length === 0) {
                taskList.innerHTML = '<p class="empty-state" style="padding: 10px; margin-top: 10px; border-top: none;">NO TASKS FOR THIS DATE.</p>';
                return;
            }
            
            taskList.innerHTML = dailyTasks.map(task => `
                <div class="task-item" data-id="${task.id}">
                    <span>${task.text}</span>
                    <button class="btn-delete" onclick="deleteTask(${task.id})">REMOVE</button>
                </div>
            `).join('');

            document.querySelectorAll('.task-item').forEach((item, index) => {
                setTimeout(() => {
                    item.style.opacity = '1';
                    item.style.transform = 'translateX(0)';
                }, 50 * index);
            });
        }
        
        function addTask() {
            const taskInput = document.getElementById('taskInput');
            const taskText = taskInput.value.trim();
            const dateKey = selectedDate.toDateString();
            if (taskText) {
                if (!tasks[dateKey]) { tasks[dateKey] = []; }
                tasks[dateKey].push({ id: Date.now(), text: taskText });
                taskInput.value = '';
                saveTasks();
                renderTasks();
                renderCalendar(); 
            } else {
                alert('Please enter a task description.');
            }
        }
        
        function deleteTask(id) {
            const dateKey = selectedDate.toDateString();
            if (tasks[dateKey]) {
                const item = document.querySelector(`.task-item[data-id="${id}"]`);
                if (item) {
                    item.style.transform = 'translateX(100%)';
                    item.style.opacity = '0';
                    item.style.height = '0';
                    item.style.marginBottom = '0';
                    item.style.paddingTop = '0';
                    item.style.paddingBottom = '0';
                }
                
                setTimeout(() => {
                    tasks[dateKey] = tasks[dateKey].filter(task => task.id !== id);
                    if (tasks[dateKey].length === 0) { delete tasks[dateKey]; }
                    saveTasks();
                    renderTasks();
                    renderCalendar();
                }, 400); 
            }
        }
        
        // --- Study Log Functions (Unchanged) ---
        function loadStudyLogs() {
            const savedLogs = localStorage.getItem('jee-study-logs');
            if (savedLogs) {
                try { studyLogs = JSON.parse(savedLogs); } catch (e) { console.error('Error loading study logs:', e); studyLogs = []; }
            }
        }

        function saveStudyLogs() {
            localStorage.setItem('jee-study-logs', JSON.stringify(studyLogs));
        }

        function parseTime(timeString) {
            const parts = timeString.split('-').map(s => s.trim());
            if (parts.length !== 2) return 0;

            const parseSingleTime = (t) => {
                const isPM = t.toUpperCase().includes('PM');
                t = t.replace(/(am|pm)/i, '').trim();
                let [h, m] = t.split(':').map(Number);
                if (isNaN(m) || isNaN(h)) {
                    h = Number(t); m = 0;
                    if (isNaN(h)) return 0;
                }
                
                if (isPM && h !== 12) h += 12;
                if (!isPM && h === 12) h = 0; 
                return h * 60 + m; 
            };

            const startMinutes = parseSingleTime(parts[0]);
            let endMinutes = parseSingleTime(parts[1]);

            if (endMinutes < startMinutes) {
                endMinutes += 24 * 60;
            }
            
            let durationMinutes = endMinutes - startMinutes;
            
            return durationMinutes / 60; 
        }

        function addStudyLog() {
            const date = document.getElementById('logDate').value;
            const time = document.getElementById('logTime').value.trim();
            const activity = document.getElementById('logActivity').value.trim();

            if (!date || !time || !activity) {
                alert('Please fill in all fields for the Study Log.');
                return;
            }
            
            const hours = parseTime(time);
            
            if (hours <= 0 || hours > 12) {
                alert('Could not calculate a positive duration from the time block. Please check the format (e.g., 10:00 AM - 1:00 PM) or ensure the duration is reasonable (max 12 hours).');
                return;
            }

            const log = { id: Date.now(), date, time, activity, hours };

            studyLogs.push(log);
            studyLogs.sort((a, b) => new Date(b.date) - new Date(a.date)); 
            saveStudyLogs();

            document.getElementById('logDate').value = '';
            document.getElementById('logTime').value = '';
            document.getElementById('logActivity').value = '';

            renderStudyLogs();
        }
        
        function deleteStudyLog(id) {
            if (confirm('Are you sure you want to delete this study session?')) {
                const item = document.querySelector(`.log-entry[data-id="${id}"]`);
                if (item) {
                    item.style.transform = 'translateX(100%)';
                    item.style.opacity = '0';
                    item.style.height = '0';
                    item.style.marginBottom = '0';
                    item.style.paddingTop = '0';
                    item.style.paddingBottom = '0';
                }
                
                setTimeout(() => {
                    studyLogs = studyLogs.filter(log => log.id !== id);
                    saveStudyLogs();
                    renderStudyLogs();
                }, 400); 
            }
        }

        function renderStudyLogs() {
            const listContainer = document.getElementById('studyLogList');
            const totalHoursSpan = document.getElementById('totalStudyHours');

            if (studyLogs.length === 0) {
                listContainer.innerHTML = '<p class="empty-state" style="padding: 10px; border-top: none;">NO STUDY SESSIONS LOGGED YET.</p>';
                totalHoursSpan.textContent = `TOTAL LOGGED: 0.0 HRS`;
                return;
            }

            const totalHours = studyLogs.reduce((sum, log) => sum + (log.hours || 0), 0);
            totalHoursSpan.textContent = `TOTAL LOGGED: ${totalHours.toFixed(1)} HRS`;
            
            listContainer.innerHTML = studyLogs.map(log => {
                const formattedDate = new Date(log.date).toLocaleDateString('en-GB');
                return `
                    <div class="log-entry" data-id="${log.id}">
                        <div class="log-details">
                            <div class="log-date-time">
                                <strong>${formattedDate}</strong> | 
                                <span class="log-time" style="color: var(--color-dark-subtext);">${log.time}</span> 
                            </div>
                            <div class="log-description" style="margin-top: 5px;">
                                ${log.activity} 
                            </div>
                        </div>
                        <div class="log-actions-wrapper">
                            <span class="log-hours">(${log.hours.toFixed(1)} HRS)</span>
                            <button class="btn-delete" onclick="deleteStudyLog(${log.id})">REMOVE</button>
                        </div>
                    </div>
                `;
            }).join('');
            
            document.querySelectorAll('#studyLogList .log-entry').forEach((item, index) => {
                setTimeout(() => {
                    item.style.opacity = '1';
                    item.style.transform = 'translateX(0)';
                }, 50 * index);
            });
        }
        
        // --- Stopwatch Functions (Unchanged Logic) ---
        function formatTime(ms) {
            const totalSeconds = Math.floor(ms / 1000);
            const hours = String(Math.floor(totalSeconds / 3600)).padStart(2, '0');
            const minutes = String(Math.floor((totalSeconds % 3600) / 60)).padStart(2, '0');
            const seconds = String(totalSeconds % 60).padStart(2, '0');
            return `${hours}:${minutes}:${seconds}`;
        }

        function updateStopwatchDisplay() {
            document.getElementById('stopwatchDisplay').textContent = formatTime(elapsedTime);
        }

        function startStopwatch() {
            const startStopBtn = document.getElementById('startStopBtn');
            const display = document.getElementById('stopwatchDisplay');

            if (!stopwatchRunning) {
                stopwatchRunning = true;
                startStopBtn.textContent = 'STOP';
                startStopBtn.classList.remove('start-btn-custom');
                startStopBtn.classList.add('stop-btn-custom');
                display.classList.add('running');

                const startTime = Date.now() - elapsedTime;
                stopwatchInterval = setInterval(() => {
                    elapsedTime = Date.now() - startTime;
                    updateStopwatchDisplay();
                }, 1000); 
            } else {
                stopwatchRunning = false;
                startStopBtn.textContent = 'START';
                startStopBtn.classList.remove('stop-btn-custom');
                startStopBtn.classList.add('start-btn-custom');
                display.classList.remove('running');
                clearInterval(stopwatchInterval);
            }
        }

        function resetStopwatch() {
            if (stopwatchRunning) {
                startStopwatch(); 
            }
            elapsedTime = 0;
            updateStopwatchDisplay();
        }

        // ------------------------------------
        // --- STUDENT HUB FUNCTIONS ---
        // ------------------------------------

        // --- GOAL SETTING ---
        function loadGoals() {
            const savedGoals = localStorage.getItem('jee-goals');
            if (savedGoals) {
                try { goals = JSON.parse(savedGoals); } catch (e) { console.error('Error loading goals:', e); goals = {}; }
            }
        }

        function saveGoals() {
            goals.targetScore = document.getElementById('targetScore').value.trim();
            goals.targetPercentile = document.getElementById('targetPercentile').value.trim();
            goals.motivationalQuote = document.getElementById('motivationalQuote').value.trim();
            localStorage.setItem('jee-goals', JSON.stringify(goals));
            renderGoals();
            alert('Goals saved!');
        }
        
        function renderGoals() {
            document.getElementById('targetScore').value = goals.targetScore || '';
            document.getElementById('targetPercentile').value = goals.targetPercentile || '';
            document.getElementById('motivationalQuote').value = goals.motivationalQuote || '';

            const display = document.getElementById('goalDisplay');
            if (goals.targetScore && goals.targetPercentile) {
                display.innerHTML = `<strong>TARGET:</strong> ${goals.targetScore} Marks | ${goals.targetPercentile}% Tile.<br>
                ${goals.motivationalQuote ? 'Motivation: <em>"' + goals.motivationalQuote + '"</em>' : ''}`;
            } else {
                 display.textContent = 'Define your goals to see your motivation here.';
            }
        }

        // --- STUDENT LOG NOTES (Unchanged) ---
        function loadStudentNotes() {
            const savedNotes = localStorage.getItem('jee-student-notes');
            if (savedNotes) {
                try { studentNotes = JSON.parse(savedNotes); } catch (e) { console.error('Error loading student notes:', e); studentNotes = []; }
            }
        }
        function saveStudentNotes() { 
            localStorage.setItem('jee-student-notes', JSON.stringify(studentNotes)); 
        }

        function addStudentNote() {
            const entryText = document.getElementById('studentLogEntry').value.trim();
            if (!entryText) {
                alert('Please write an entry for the log.');
                return;
            }

            const note = { 
                id: Date.now(), 
                date: new Date().toISOString().split('T')[0], 
                text: entryText 
            };

            studentNotes.push(note);
            studentNotes.sort((a, b) => new Date(b.date) - new Date(a.date)); // Newest first
            saveStudentNotes();

            document.getElementById('studentLogEntry').value = '';
            renderStudentNotes();
        }

        function deleteStudentNote(id) {
            if (confirm('Are you sure you want to delete this reflection?')) {
                const item = document.querySelector(`.student-note-entry[data-id="${id}"]`);
                if (item) {
                    item.style.transform = 'translateX(100%)';
                    item.style.opacity = '0';
                    item.style.height = '0';
                    item.style.marginBottom = '0';
                    item.style.paddingTop = '0';
                    item.style.paddingBottom = '0';
                }
                
                setTimeout(() => {
                    studentNotes = studentNotes.filter(note => note.id !== id);
                    saveStudentNotes();
                    renderStudentNotes();
                }, 400); 
            }
        }

        function renderStudentNotes() {
            const listContainer = document.getElementById('studentNoteList');

            if (studentNotes.length === 0) {
                listContainer.innerHTML = '<p class="empty-state" style="padding: 10px; border-top: none;">No student log entries yet.</p>';
                return;
            }

            listContainer.innerHTML = studentNotes.map(note => {
                const formattedDate = new Date(note.date).toLocaleDateString('en-GB');
                return `
                    <div class="student-note-entry" data-id="${note.id}">
                        <div class="student-note-header">
                            <strong>${formattedDate}</strong>
                            <button class="btn-delete" onclick="deleteStudentNote(${note.id})">REMOVE</button>
                        </div>
                        <div class="student-note-text">${note.text}</div>
                    </div>
                `;
            }).join('');

            // Animate new entries
            document.querySelectorAll('#studentNoteList .student-note-entry').forEach((item, index) => {
                setTimeout(() => {
                    item.classList.add('log-visible');
                }, 50 * index);
            });
        }


        // --- SYLLABUS TRACKER ---
        function loadSyllabus() {
            const savedSyllabus = localStorage.getItem('jee-syllabus');
            if (savedSyllabus) {
                try { syllabusItems = JSON.parse(savedSyllabus); } catch (e) { console.error('Error loading syllabus:', e); syllabusItems = []; }
            }
        }
        function saveSyllabus() { localStorage.setItem('jee-syllabus', JSON.stringify(syllabusItems)); }

        function addSyllabusItem() {
            const subject = document.getElementById('syllabusSubject').value;
            const chapter = document.getElementById('syllabusChapter').value.trim();
            const status = document.getElementById('syllabusStatus').value;

            if (!chapter) {
                alert('Please enter a chapter name.');
                return;
            }

            const item = { id: Date.now(), subject, chapter, status };
            syllabusItems.push(item);
            saveSyllabus();
            renderSyllabusTracker();
            document.getElementById('syllabusChapter').value = '';
        }

        function deleteSyllabusItem(id) {
            syllabusItems = syllabusItems.filter(item => item.id !== id);
            saveSyllabus();
            renderSyllabusTracker();
        }

        function updateSyllabusItemStatus(id, newStatus) {
            const item = syllabusItems.find(i => i.id === id);
            if (item) {
                item.status = newStatus;
                saveSyllabus();
                renderSyllabusTracker();
            }
        }

        function renderSyllabusTracker() {
            const tbody = document.getElementById('syllabusTableBody');
            const summary = document.getElementById('syllabusProgressSummary');

            if (syllabusItems.length === 0) {
                tbody.innerHTML = '<tr><td colspan="4" style="text-align: center;">NO CHAPTERS ADDED YET.</td></tr>';
                summary.textContent = 'Total Chapters: 0 | Completed: 0%';
                return;
            }

            const sortedItems = syllabusItems.sort((a, b) => {
                if (a.subject !== b.subject) return a.subject.localeCompare(b.subject);
                if (a.status === 'Completed' && b.status !== 'Completed') return 1;
                if (a.status !== 'Completed' && b.status === 'Completed') return -1;
                return a.chapter.localeCompare(b.chapter);
            });


            tbody.innerHTML = sortedItems.map(item => {
                const isCompleted = item.status === 'Completed';
                const rowClass = isCompleted ? 'completed' : '';
                return `
                    <tr class="${rowClass}">
                        <td class="syllabus-subject" style="color: ${isCompleted ? 'inherit' : (item.subject === 'Physics' ? '#888' : item.subject === 'Chemistry' ? '#666' : '#444')}">${item.subject}</td>
                        <td style="font-weight: 600;">${item.chapter}</td>
                        <td>
                            <select class="syllabus-status-select" onchange="updateSyllabusItemStatus(${item.id}, this.value)">
                                <option value="Pending" ${item.status === 'Pending' ? 'selected' : ''}>Pending</option>
                                <option value="Revision 1" ${item.status === 'Revision 1' ? 'selected' : ''}>Revision 1</option>
                                <option value="Completed" ${item.status === 'Completed' ? 'selected' : ''}>Completed</option>
                            </select>
                        </td>
                        <td><button class="btn-delete" onclick="deleteSyllabusItem(${item.id})">DELETE</button></td>
                    </tr>
                `;
            }).join('');

            const totalChapters = syllabusItems.length;
            const completedChapters = syllabusItems.filter(i => i.status === 'Completed').length;
            const percentage = totalChapters > 0 ? ((completedChapters / totalChapters) * 100).toFixed(1) : 0;

            summary.textContent = `Total Chapters: ${totalChapters} | Completed: ${completedChapters} (${percentage}%)`;
        }

        // --- RESOURCE LINKS ---
        function loadResources() {
            const savedResources = localStorage.getItem('jee-resources');
            if (savedResources) {
                try { resourceLinks = JSON.parse(savedResources); } catch (e) { console.error('Error loading resources:', e); resourceLinks = []; }
            }
        }
        function saveResources() { localStorage.setItem('jee-resources', JSON.stringify(resourceLinks)); }

        function addResourceLink() {
            const name = document.getElementById('resourceName').value.trim();
            const url = document.getElementById('resourceURL').value.trim();

            if (!name || !url) {
                alert('Please enter both a name and a URL.');
                return;
            }
            if (!url.startsWith('http')) {
                alert('Please enter a valid URL (include http:// or https://).');
                return;
            }

            const link = { id: Date.now(), name, url };
            resourceLinks.push(link);
            saveResources();
            renderResourceLinks();

            document.getElementById('resourceName').value = '';
            document.getElementById('resourceURL').value = '';
        }

        function deleteResourceLink(id) {
            resourceLinks = resourceLinks.filter(link => link.id !== id);
            saveResources();
            renderResourceLinks();
        }

        function renderResourceLinks() {
            const listContainer = document.getElementById('resourceLinkList');

            if (resourceLinks.length === 0) {
                listContainer.innerHTML = '<p class="empty-state" style="padding: 10px; border-top: none;">No resources saved yet.</p>';
                return;
            }

            listContainer.innerHTML = resourceLinks.map(link => `
                <div class="resource-entry">
                    <a href="${link.url}" target="_blank">${link.name}</a>
                    <button class="btn-delete" onclick="deleteResourceLink(${link.id})">DELETE</button>
                </div>
            `).join('');
        }
    </script>
</body>
</html>
